<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Four Column Web Page</title>
<style>
 body {
    background-image: url('https://img.freepik.com/free-vector/simple-blue-gradient-background-vector-business_53876-174922.jpg?size=626&ext=jpg&ga=GA1.1.735520172.1711411200&semt=ais');  /* Replace with your image path */
    /*background-repeat: no-repeat;  /* Optional: Controls how the image repeats */
    /*background-position: center;  /* Optional: Positions the image within the element */
    background-size: cover;      /* Optional: Controls how the image fits the element */
  }
  /*<meta name="viewport" content="width=device-width, initial-scale=1.0">*/

  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    text-align: left;
    padding: 8px;
    border: 1px solid #ddd;
  }
  th {
    background-color: #f2f2f2;
  }
  h1 {
    text-align: center;
  }
 
  h2 {
    text-align: center;
  }
  .details {
            display: none;
  }
  .wide-input {
        width: 300px; /* or you can use percentages like 100% to fill the container */
  }
</style>
</head>
<body>
<h1>Comparision of Accessibiltiy tools</h1>
<h2>Accessibiltiy Testing</h2>
<label> URL:&nbsp; </label>
<input id="urlChecker" class="wide-input" placeholder="Enter Url for Accessibility Check" >
<label>&nbsp;&nbsp;&nbsp;</label>
<button id="runNpmBtn" onclick="storeText()">Check It</button>
<!-- <button id="runNpmBtn">Check It</button> -->
<div id="displayText"></div>
<br>
<br>
<table id='table001'>
  <tr>
    <th>Accessible Check</th>
    <th>Wave</th>
    <th>AChecker</th>
    <th>Lighthouse</th>
    <th>Details</th>
  </tr>
  <!-- <tr>
    <td id='key001'>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
  </tr>
  <tr>
    <td id='key002'>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
  </tr>
  <tr>
    <td id='key003'>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
  </tr>
  <tr>
    <td id='key004'>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
    <td>Result</td>
  </tr> -->

  
  <!-- Add more rows here as needed -->
</table>

<script>
    let myMap = new Map();
    let rowCount = 1;
    document.getElementById('runNpmBtn').addEventListener('click', function() {
            //console.log("Check It Amit");
            
            fetch('http://localhost:5500/npm')
                .then(response => response.json())
                .then(data => console.log(data))
                .catch(error => console.error('Error:', error));
        });
    function storeText() {
      var inputText = document.getElementById("urlChecker").value;
      document.getElementById("displayText").innerText = inputText;
      fetch('http://localhost:5500/update-json', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ "baseURL": inputText })
        })
        .then(response => response.text())
        .then(data => console.log(data))
        .catch(error => console.error('Error:', error));
    }
    function toggleDetails(detailsId) {
      console.log(detailsId);
            var details = document.getElementById(detailsId);
            if (details.style.display === 'none') {
                details.style.display = 'table-row';
            } else {
                details.style.display = 'none';
            }
            
        }


    function fetchWithTimeout(resource, options) {
          const { timeout = 500000 } = options;

          const controller = new AbortController();
          const id = setTimeout(() => controller.abort(), timeout);

          return fetch(resource, {
              ...options,
              signal: controller.signal
          })
          .then(response => {
              clearTimeout(id);
              return response;
          })
          .catch(error => {
              clearTimeout(id);
              throw error;
          });
    }
    function fetchData(){
    fetch('wave_data.json')
        .then(response => response.json())
        .then(data => {
          
            const keys = Object.keys(data);
            // document.getElementById('key001').innerText=keys[0];
            // document.getElementById('key002').innerText=keys[1];
            // document.getElementById('key003').innerText=keys[2];
            // document.getElementById('key004').innerText=keys[3];
            const table = document.getElementById('table001').getElementsByTagName('tbody')[0];
            // // Assuming each key in the JSON object is an array of string items
            Object.keys(data).forEach(key => {
                    myMap.set(key, rowCount);
                // data[key].forEach(item => {
                    const row = table.insertRow();
                    const cell = row.insertCell();
                    const cell1 = row.insertCell();
                    const cell2 = row.insertCell();
                    const cell3 = row.insertCell();
                    const cell4 = row.insertCell(); 
                    cell1.setAttribute('data-id', key+' wave');
                    cell2.setAttribute('data-id', key+' achecker');
                    cell3.setAttribute('data-id', key+' lighthouse');
                    cell.innerText = key;
                    //cell1.innerText = data[key]; // Using innerHTML to render the HTML content
                    cell1.innerText = data[key].length;
                    cell2.innerText = 0;
                    cell3.innerText = 0;
                    var button = document.createElement("button");
                    button.innerHTML = "Compare";
                    button.id = "button"+rowCount;
                    button.onclick = function() {
                      console.log("Button clicked, rowCount is " + rowCount);
                      toggleDetails('details'+button.getAttribute('id').split('button')[1]);
                    };
                    cell4.appendChild(button);
                    var newRow = document.createElement("tr");
                    newRow.id = "details"+rowCount;
                    newRow.className = "details";
                    newRow.setAttribute('data-id',key);
                    const newCell=newRow.insertCell();
                    const newCell1=newRow.insertCell();
                    const newCell2=newRow.insertCell();
                    const newCell3=newRow.insertCell();
                    newCell1.setAttribute('data-id', 'new cell '+key+' wave');
                    newCell2.setAttribute('data-id', 'new cell '+key+' achecker');
                    newCell3.setAttribute('data-id', 'new cell '+key+' lighthouse');
                    newCell1.innerText= data[key];
                    
                    table.appendChild(newRow);
                    
                    rowCount++;
                // });
            });
            
            
        })
        .catch(error => {
            console.error('Error fetching or parsing the JSON file:', error);
        });

  fetch('achecker_data.json')
      .then(response => response.json())
      .then(data => {
          
          const keys = Object.keys(data);
          // document.getElementById('key001').innerText=keys[0];
          // document.getElementById('key002').innerText=keys[1];
          // document.getElementById('key003').innerText=keys[2];
          // document.getElementById('key004').innerText=keys[3];
          const table = document.getElementById('table001').getElementsByTagName('tbody')[0];
          // // Assuming each key in the JSON object is an array of string items
          Object.keys(data).forEach(key => {
              // data[key].forEach(item => {
                  let flag = false;
                  for (let index = 0; index < table.rows.length; index++) {
                    let errorName=table.rows[index].cells[0].innerHTML;
                    
                    if(myMap.get('Missing alternative text')!=undefined){
                      if(key == 'img element missing alt attribute.') {
                          // if(table.rows[myMap.get('Missing alternative text')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Missing alternative text')+1].cells[2].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing alternative text')+2].cells[2].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Missing alternative text')].cells[2].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing alternative text')+1].cells[2].innerText = data[key];
                          // }
                          //table.rows[myMap.get('Missing alternative text')].cells[2].innerText = data[key].length;
                          //table.rows[myMap.get('Missing alternative text')+1].cells[2].innerText = data[key];
                          // console.log("Outside");
                          const existing_cell = document.querySelector('td[data-id="Missing alternative text achecker"]');  
                          const existing_cell1 = document.querySelector('td[data-id="new cell Missing alternative text achecker"]'); 

                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          
                          flag=true;
                          break;
                      }
                    }
                    if(myMap.get('Missing form label')!=undefined){
                      if(key.includes('missing an associated label.')) {
                          //table.rows[myMap.get('Missing form label')].cells[2].innerText = data[key];
                          // if(table.rows[myMap.get('Missing form label')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Missing form label')+1].cells[2].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing form label')+2].cells[2].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Missing form label')].cells[2].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing form label')+1].cells[2].innerText = data[key];
                          // }
                          
                          //table.rows[myMap.get('Missing form label')].cells[2].innerText = data[key].length;
                          const existing_cell = document.querySelector('td[data-id="Missing form label achecker"]'); 
                          const existing_cell1 = document.querySelector('td[data-id="new cell Missing form label achecker"]');  
                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          flag=true;
                          break;
                      }
                    }
                    
                  }
                  if(flag == true){
                    return;
                  }
                  const row = table.insertRow();
                  const cell = row.insertCell();
                  const cell1 = row.insertCell();
                  const cell2 = row.insertCell();
                  const cell3 = row.insertCell();
                  const cell4 = row.insertCell();
                  
                  cell.innerText = key;
                  //cell2.innerText = data[key]; // Using innerHTML to render the HTML content
                  cell2.innerText = data[key].length;
                  cell1.innerText = 0;
                  cell3.innerText = 0;
                  var button = document.createElement("button");
                    button.innerHTML = "Compare";
                    button.id = "button"+rowCount;
                    button.onclick = function() {
                      console.log("Button clicked, rowCount is " + rowCount);
                      toggleDetails('details'+button.getAttribute('id').split('button')[1]);
                    };
                    cell4.appendChild(button);
                    var newRow = document.createElement("tr");
                    newRow.id = "details"+rowCount;
                    newRow.className = "details";
                    const newCell=newRow.insertCell();
                    const newCell1=newRow.insertCell();
                    const newCell2=newRow.insertCell();
                    const newCell3=newRow.insertCell();
                    newCell1.setAttribute('data-id', 'new cell '+key+' wave');
                    newCell2.setAttribute('data-id', 'new cell '+key+' achecker');
                    newCell3.setAttribute('data-id', 'new cell '+key+' lighthouse');
                    newCell2.innerText= data[key];
                    
                    table.appendChild(newRow);
                    
                    rowCount++;
              // });
          });
          
      })
      .catch(error => {
          console.error('Error fetching or parsing the JSON file:', error);
      });
  fetch('lighthouse_data.json')
      .then(response => response.json())
      .then(data => {
          
          const keys = Object.keys(data);
          // document.getElementById('key001').innerText=keys[0];
          // document.getElementById('key002').innerText=keys[1];
          // document.getElementById('key003').innerText=keys[2];
          // document.getElementById('key004').innerText=keys[3];
          const table = document.getElementById('table001').getElementsByTagName('tbody')[0];
          // // Assuming each key in the JSON object is an array of string items
          Object.keys(data).forEach(key => {
              // data[key].forEach(item => {
                  let flag = false;
                  for (let index = 0; index < table.rows.length; index++) {
                    let errorName=table.rows[index].cells[0].innerHTML;
                    
                    if(myMap.get('Missing alternative text')!=undefined){
                      if(key == 'Image elements do not have `[alt]` attributes') {
                          // if(table.rows[myMap.get('Missing alternative text')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Missing alternative text')+1].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing alternative text')+2].cells[3].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Missing alternative text')].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing alternative text')+!].cells[3].innerText = data[key];
                          // }
                          //table.rows[myMap.get('Missing alternative text')].cells[3].innerText = data[key];
                          //table.rows[myMap.get('Missing alternative text')].cells[3].innerText = data[key].length;
                          const existing_cell = document.querySelector('td[data-id="Missing alternative text lighthouse"]');  
                          const existing_cell1 = document.querySelector('td[data-id="new cell Missing alternative text lighthouse"]');  
                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          flag=true;
                          break;
                      }
                    }
                    if(myMap.get('Empty button')!=undefined){
                      if(key.includes('Buttons do not have an accessible name')) {
                          // if(table.rows[myMap.get('Empty button')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Empty button')+1].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Empty button')+2].cells[3].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Empty button')].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Empty button')+1].cells[3].innerText = data[key];
                          // }
                          //table.rows[myMap.get('Empty button')].cells[3].innerText = data[key];
                          //table.rows[myMap.get('Empty button')].cells[3].innerText = data[key].length;
                          const existing_cell = document.querySelector('td[data-id="Empty button lighthouse"]');  
                          const existing_cell1 = document.querySelector('td[data-id="new cell Empty button lighthouse"]');  
                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          flag=true;
                          break;
                      }
                    }
                    if(myMap.get('Empty link')!=undefined){
                      if(key.includes('Links do not have a discernible name')) {
                          // if(table.rows[myMap.get('Empty link')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Empty link')+1].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Empty link')+2].cells[3].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Empty link')].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Empty link')+1].cells[3].innerText = data[key];
                          // }
                          //table.rows[myMap.get('Empty link')].cells[3].innerText = data[key];
                          //table.rows[myMap.get('Empty link')].cells[3].innerText = data[key].length;
                          const existing_cell = document.querySelector('td[data-id="Empty link lighthouse"]');  
                          const existing_cell1 = document.querySelector('td[data-id="new cell Empty link lighthouse"]');  
                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          flag=true;
                          break;
                      }
                    }
                    if(myMap.get('Missing form label')!=undefined){
                      if(key.includes('Form elements do not have associated label')) {
                          // if(table.rows[myMap.get('Missing form label')].getAttribute('class')=='details'){
                          //   table.rows[myMap.get('Missing form label')+1].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing form label')+2].cells[3].innerText = data[key];
                          // }
                          // else{
                          //   table.rows[myMap.get('Missing form label')].cells[3].innerText = data[key].length;
                          //   table.rows[myMap.get('Missing form label')+!].cells[3].innerText = data[key];
                          // }
                          //table.rows[myMap.get('Missing form label')].cells[3].innerText = data[key];
                          //table.rows[myMap.get('Missing form label')].cells[3].innerText = data[key].length;
                          const existing_cell = document.querySelector('td[data-id="Missing form label lighthouse"]');  
                          const existing_cell1 = document.querySelector('td[data-id="new cell Missing form label lighthouse"]');  
                          // row.cells[2].innerText = data[key];
                          existing_cell.innerText = data[key].length;
                          existing_cell1.innerText = data[key];
                          flag=true;
                          break;
                      }
                    }
                    
                  }
                  
                  if(flag == true){
                    return;
                  }

                  const row = table.insertRow();
                  const cell = row.insertCell();
                  const cell1 = row.insertCell();
                  const cell2 = row.insertCell();
                  const cell3 = row.insertCell();
                  const cell4 = row.insertCell();
                  cell.innerText = key;
                  //cell3.innerText = data[key]; // Using innerHTML to render the HTML content
                  cell3.innerText = data[key].length; 
                  cell1.innerText = 0; 
                  cell2.innerText = 0; 
                  var button = document.createElement("button");
                    button.innerHTML = "Compare";
                    button.id = "button"+rowCount;
                    button.onclick = function() {
                      console.log("Button clicked, rowCount is " + rowCount);
                      toggleDetails('details'+button.getAttribute('id').split('button')[1]);
                    };
                    cell4.appendChild(button);
                    var newRow = document.createElement("tr");
                    newRow.id = "details"+rowCount;
                    newRow.className = "details";
                    const newCell=newRow.insertCell();
                    const newCell1=newRow.insertCell();
                    const newCell2=newRow.insertCell();
                    const newCell3=newRow.insertCell();
                    newCell1.setAttribute('data-id', 'new cell '+key+' wave');
                    newCell2.setAttribute('data-id', 'new cell '+key+' achecker');
                    newCell3.setAttribute('data-id', 'new cell '+key+' lighthouse');
                    newCell3.innerText= data[key];
                    
                    table.appendChild(newRow);
                    
                    rowCount++;
                  
              // });
          });
          
      })
      .catch(error => {
          console.error('Error fetching or parsing the JSON file:', error);
      });
    }

    fetchData();
</script>



</body>
</html>
